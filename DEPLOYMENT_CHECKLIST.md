# 云端部署验证清单

使用此清单确保部署前的所有准备工作都已完成。

## 代码准备

- [ ] 代码已提交到 Git 仓库
- [ ] 所有依赖都在 `package.json` 中
- [ ] 构建脚本配置正确（`vercel.json` 已创建）
- [ ] `.gitignore` 已配置，排除敏感文件
- [ ] `.env.example` 已创建（不包含真实密钥）

## 环境变量

- [ ] 已配置 `NEXT_PUBLIC_APP_URL`
- [ ] 已配置 `NEXT_PUBLIC_APP_NAME`
- [ ] 已配置 `NODE_ENV=production`
- [ ] 如需数据库，已配置 `DATABASE_URL`
- [ ] 如需对象存储，已配置 AWS 相关变量

## 功能测试

- [ ] 本地构建成功 (`pnpm run build`)
- [ ] 本地运行正常 (`pnpm start`)
- [ ] 所有页面可以访问
- [ ] API 接口正常工作
- [ ] 样式显示正常

## 安全检查

- [ ] 移除了所有调试代码
- [ ] 硬编码的密钥已移除
- [ ] 错误信息不泄露敏感数据
- [ ] API 路由有适当的认证
- [ ] CORS 配置正确

## 性能优化

- [ ] 图片已优化
- [ ] 代码已压缩
- [ ] 使用了代码分割
- [ ] 启用了缓存策略
- [ ] 数据库查询已优化

## 部署平台配置

### Vercel
- [ ] 已创建 Vercel 账号
- [ ] 已连接 GitHub 仓库
- [ ] 环境变量已配置
- [ ] 域名已配置（可选）
- [ ] HTTPS 已启用

### Docker
- [ ] Dockerfile 已创建
- [ ] docker-compose.yml 已创建
- [ ] 镜像构建成功
- [ ] 容器运行正常

### 云服务器
- [ ] 服务器已配置
- [ ] Node.js 已安装
- [ ] Nginx 已配置
- [ ] SSL 证书已配置
- [ ] 防火墙已设置

## 监控与日志

- [ ] 日志收集已配置
- [ ] 错误监控已配置
- [ ] 性能监控已配置
- [ ] 告警规则已设置

## 备份与恢复

- [ ] 数据库备份策略已制定
- [ ] 配置文件已备份
- [ ] 恢复流程已测试
- [ ] 备份存储位置已确定

## 文档

- [ ] 部署文档已更新
- [ ] API 文档已准备
- [ ] 用户手册已准备
- [ ] 故障排查文档已准备

## 测试环境

- [ ] 预发布环境已部署
- [ ] 所有测试用例通过
- [ ] 性能测试已完成
- [ ] 安全测试已完成

## 上线检查

- [ ] DNS 解析正常
- [ ] HTTPS 证书有效
- [ ] 网站可以访问
- [ ] 所有功能正常
- [ ] 性能指标达标
- [ ] 监控告警正常

## 回滚计划

- [ ] 回滚流程已准备
- [ ] 备份数据可恢复
- [ ] 回滚时间已评估
- [ ] 团队已通知

---

## 快速检查命令

```bash
# 1. 检查构建
pnpm run build

# 2. 检查类型
pnpm run ts-check

# 3. 检查依赖
pnpm list

# 4. 检查环境变量
cat .env.local

# 5. 运行部署脚本
./deploy-vercel.sh
```

## 常见问题排查

### 构建失败
- 检查 Node.js 版本（需要 18+）
- 检查依赖是否完整安装
- 检查类型错误

### 运行时错误
- 检查环境变量是否配置
- 检查数据库连接
- 检查 API 端点

### 性能问题
- 启用缓存
- 优化图片
- 使用 CDN
- 数据库索引优化

## 部署后验证

```bash
# 检查网站状态
curl -I https://your-domain.com

# 检查响应时间
time curl https://your-domain.com

# 检查 SSL 证书
openssl s_client -connect your-domain.com:443 -servername your-domain.com
```
