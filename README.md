<<<<<<< HEAD
# Passive Edge 订单生产测试管理系统

## 项目概述

Passive Edge 订单生产测试管理系统是一个专为相变材料行业设计的综合业务管理平台，涵盖订单管理、配方管理、物料管理、配方测试等核心功能模块，提供完整的业务流程管理和数据分析能力。

## 核心功能

### 1. 数据仪表盘
- 实时展示关键业务指标（订单数、配方数、测试数等）
- 可视化数据图表（订单趋势、配方分布等）
- 快捷操作入口
- 低库存预警提醒

### 2. 订单管理模块
- 订单创建、编辑、查询、筛选
- 订单状态追踪（待处理、生产中、已完成、已取消）
- 客户信息管理与订单关联
- 订单数据统计与导出功能
- 订单优先级管理

### 3. 配方管理模块
- 相变材料配方库建立与版本控制
- 配方参数可视化展示（相变温度、潜热、导热系数等）
- 配方与订单的关联机制
- 配方搜索与快速引用功能
- 版本历史记录与对比
- 配方材料组成管理

### 4. 物料管理模块
- 原材料库存实时监控与预警
- **入库单管理**
  - 入库单创建与审批
  - 供应商信息关联
  - 入库明细记录
  - 入库单打印与导出
  - 审批流程管理
- **出库单管理**
  - 出库单创建与审批
  - 客户信息关联
  - 出库明细记录
  - 出库单打印与导出
  - 关联订单追溯
- 物料与配方的关联配置
- 供应商信息管理与物料溯源
- 批次管理与有效期追踪
- 库存价值统计

### 5. 配方测试模块
- 测试流程记录与状态跟踪
- 测试数据可视化呈现（温度变化曲线、对比图表）
- 测试报告自动生成与导出
- 测试标准与参数模板管理
- 测试结果判定与合格率统计

### 6. 系统设置
- 基本系统配置
- 用户管理
- 角色与权限管理
- 操作日志记录
- 数据备份与恢复
- 通知设置
- **密码管理**
  - 修改登录密码
  - 密码安全策略

## 认证与安全

### 登录认证

系统采用 Cookie-based 认证机制，提供安全的用户登录和会话管理。

#### 默认账号信息

```
用户名: admin
密码: admin123
```

**⚠️ 安全提示**：首次登录后请立即修改默认密码！

#### 访问控制

- **未登录用户**：自动重定向到登录页面 (`/login`)
- **登录用户**：可访问所有系统模块
- **路由保护**：中间件自动保护所有非公开路由
- **会话管理**：Cookie 有效期为 24 小时

#### 修改密码

1. 登录系统后，点击侧边栏的"系统设置"
2. 在"修改密码"区域输入当前密码和新密码
3. 新密码长度至少 6 位
4. 点击"修改密码"按钮
5. 密码修改成功后需要重新登录

#### 退出登录

点击侧边栏用户信息区域的退出按钮（LogOut 图标）即可安全退出系统。

### 安全特性

- 密码 Base64 编码存储（生产环境建议使用更安全的加密方式）
- 会话令牌验证
- 路由级别访问控制
- 自动会话过期

## 技术栈

- **框架**: Next.js 16 (App Router)
- **语言**: TypeScript 5
- **UI组件库**: shadcn/ui (基于 Radix UI)
- **样式**: Tailwind CSS 4
- **图表**: Recharts
- **构建工具**: Coze CLI

## 项目结构

```
src/
├── app/                    # Next.js App Router
│   ├── page.tsx           # 仪表盘页面
│   ├── orders/            # 订单管理
│   ├── formulas/          # 配方管理
│   ├── materials/         # 物料管理
│   ├── tests/             # 配方测试
│   ├── statistics/        # 数据统计
│   ├── settings/          # 系统设置
│   ├── layout.tsx         # 全局布局
│   └── globals.css        # 全局样式
├── components/            # 组件
│   ├── ui/               # shadcn/ui 基础组件
│   └── app-sidebar.tsx   # 侧边栏导航
├── types/                # TypeScript 类型定义
│   └── index.ts          # 业务模型类型
└── lib/                  # 工具函数
    └── utils.ts          # 通用工具
```

## 业务流程

### 订单生产流程
1. 客户下单 → 创建订单
2. 选择配方 → 关联配方版本
3. 物料需求检查 → 库存不足预警
4. 创建出库单 → 提交审批
5. 出库审批 → 物料出库
6. 生产执行 → 订单状态更新
7. 质量测试 → 测试记录
8. 测试完成 → 订单状态联动
9. 完成交付 → 订单完成

### 物料入库流程
1. 采购下单 → 供应商发货
2. 货物到库 → 创建入库单
3. 录入明细 → 填写物料信息
4. 提交审批 → 等待审批
5. 审批通过 → 物料入库
6. 库存更新 → 实时同步
7. 生成入库单据 → 打印/导出

### 物料出库流程
1. 领料申请 → 创建出库单
2. 关联订单 → 填写领料信息
3. 库存检查 → 确认充足
4. 提交审批 → 等待审批
5. 审批通过 → 物料出库
6. 库存更新 → 实时同步
7. 生成出库单据 → 打印/导出
8. 订单状态更新 → 开始生产

### 配方管理流程
1. 创建配方 → 配置参数
2. 材料配比 → 定义组成
3. 版本发布 → 版本控制
4. 应用到订单 → 关联使用
5. 持续优化 → 版本迭代

### 测试管理流程
1. 发起测试 → 选择测试标准
2. 执行测试 → 数据采集
3. 结果分析 → 可视化展示
4. 判定合格 → 生成报告
5. 报告导出 → 归档保存

## 系统特性

### 🔄 实时联动系统
- **实时通知中心**
  - 库存预警通知
  - 订单状态变更通知
  - 测试完成通知
  - 单据审批通知
  - 配方更新通知
- **模块间数据联动**
  - 订单创建自动检查物料库存
  - 物料出入库实时更新库存
  - 测试完成自动更新订单状态
  - 配方更新通知关联订单
- **实时数据同步**
  - 仪表盘数据实时刷新
  - 库存数据实时计算
  - 测试数据实时记录
  - 统计数据定时更新
- **业务流程自动化**
  - 自动创建出入库单
  - 自动触发审批流程
  - 自动更新状态流转
  - 自动发送预警通知

### 响应式设计
- 完全适配 PC 端与平板设备
- 灵活的网格布局系统
- 移动端友好的交互设计

### 模块化架构
- 清晰的功能模块划分
- 可扩展的组件体系
- 灵活的权限配置

### 数据可视化
- 丰富的图表展示
- 实时数据更新
- 交互式数据分析

### 安全与审计
- 用户权限控制
- 操作日志记录
- 数据备份机制

## 开发命令

```bash
# 安装依赖
pnpm install

# 启动开发服务器
coze dev

# 构建生产版本
coze build

# 启动生产服务器
coze start
```

## 快速开始

**想要快速部署到云端？** 查看 [快速开始指南](./QUICK_START.md)，3 步即可完成部署！

### 运行部署助手

```bash
# 一键部署准备
./deploy-vercel.sh
```

详细步骤请参考 [QUICK_START.md](./QUICK_START.md)

## 云端部署

### 快速部署到 Vercel（推荐）

Vercel 是 Next.js 官方推荐的部署平台，提供免费额度。

#### 使用部署脚本

```bash
# 运行部署助手
./deploy-vercel.sh
```

脚本会自动：
- ✅ 检查环境
- ✅ 安装依赖
- ✅ 运行类型检查
- ✅ 构建项目
- ✅ 准备 Git 仓库

#### 手动部署步骤

1. **准备代码仓库**
```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/your-username/your-repo.git
git push -u origin main
```

2. **在 Vercel 创建项目**
   - 访问 https://vercel.com/new
   - 导入你的 GitHub 仓库
   - 点击 Deploy

3. **配置环境变量**
```
NEXT_PUBLIC_APP_URL=https://your-project.vercel.app
NEXT_PUBLIC_APP_NAME=Passive Edge 订单生产测试管理系统
NODE_ENV=production
```

### 其他部署方式

- **Docker 部署**：使用 Docker 容器化部署
- **云服务器部署**：阿里云、腾讯云等
- **详细文档**：查看 [DEPLOYMENT.md](./DEPLOYMENT.md)

### 免费数据库推荐

- [Supabase](https://supabase.com) - PostgreSQL 数据库
- [Neon](https://neon.tech) - Serverless PostgreSQL
- [PlanetScale](https://planetscale.com) - MySQL 数据库


## 部署说明

系统默认运行在 **5000** 端口，通过以下命令启动：

```bash
coze dev  # 开发环境
coze start  # 生产环境
```

### Vercel 云端部署（推荐）

本系统支持一键部署到 Vercel 平台，提供以下优势：

- ✅ 全球 CDN 加速
- ✅ 自动 HTTPS
- ✅ 持续集成/部署
- ✅ 免费额度充足

**快速开始**：
1. 查看 [快速部署验证](./VERCEL_QUICK_START.md)
2. 参考 [详细部署指南](./VERCEL_DEPLOYMENT.md)
3. 运行部署前检查：`bash scripts/pre-deploy-check.sh`

**部署验证**：
```bash
# 使用健康检查脚本验证部署
bash scripts/health-check.sh https://your-domain.vercel.app
```

**必需配置**：
- PostgreSQL 数据库（推荐 Supabase 或 Neon）
- AWS S3 对象存储（或兼容服务）
- 环境变量配置（详见部署文档）

### 本地开发部署

## 浏览器支持

- Chrome (推荐)
- Firefox
- Safari
- Edge

## 相变材料行业特性

系统针对相变材料行业的专业特性进行了优化：

1. **配方参数管理**
   - 相变温度控制
   - 潜热能量管理
   - 导热系数监控
   - 循环稳定性追踪

2. **性能测试**
   - 热性能测试
   - 相变特性分析
   - 稳定性验证
   - 抗菌性能测试

3. **质量控制**
   - 批次管理
   - 有效期追踪
   - 供应商溯源
   - 测试标准管理

## 后续优化方向

1. **数据集成**
   - 集成 ERP 系统
   - 连接生产设备
   - 自动化数据采集

2. **智能分析**
   - AI 辅助配方设计
   - 预测性维护
   - 智能库存管理

3. **移动端支持**
   - 开发移动 App
   - 实时消息推送
   - 移动审批流程

## 📚 相关文档

- [实时联动说明](./REALTIME_INTEGRATION.md) - 详细的实时联动机制和业务流程说明
- [单据管理指南](./DOCUMENT_GUIDE.md) - 入库单/出库单使用指南（待完善）
- [认证系统指南](./AUTH_GUIDE.md) - 登录认证和密码管理说明
- [Vercel 部署指南](./VERCEL_DEPLOYMENT.md) - 详细的 Vercel 云端部署配置指南
- [快速部署验证](./VERCEL_QUICK_START.md) - Vercel 快速部署验证步骤
- [Vercel 故障排查](./VERCEL_TROUBLESHOOTING.md) - Vercel 部署常见问题和解决方案

## 💡 使用提示

### 实时联动功能

1. **通知中心**: 顶部铃铛图标查看实时通知
2. **数据刷新**: 仪表盘显示"实时同步中"标识
3. **状态联动**: 订单、测试、配方状态自动同步
4. **库存预警**: 物料库存低于最小值自动预警

### 单据管理

1. **创建入库单**: 物料管理 → 入库单管理 → 创建入库单
2. **创建出库单**: 物料管理 → 出库单管理 → 创建出库单
3. **审批流程**: 待审批单据 → 查看详情 → 审批通过/拒绝
4. **单据导出**: 单据详情 → 导出Excel / 打印单据

### 快捷操作

- 仪表盘快捷入口可直接创建订单、配方、测试等
- 订单列表支持批量操作和导出
- 物料列表支持快捷创建入库/出库单
- 测试列表支持快速生成报告

## 许可证

Copyright © 2024 Passive Edge. All rights reserved.
