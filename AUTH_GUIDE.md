# 认证系统使用指南

## 概述

Passive Edge 系统提供完整的用户认证功能，包括登录、会话管理和密码管理。

## 登录系统

### 访问登录页面

系统启动后，访问任意页面都会自动重定向到登录页面：

```
http://localhost:5000/login
```

### 默认账号

系统预置了一个管理员账号：

```
用户名: admin
密码: admin123
```

**⚠️ 重要提示**：
- 首次登录后请立即修改密码
- 不要在生产环境使用默认密码
- 建议定期更换密码以保障安全

### 登录流程

1. 在登录页面输入用户名和密码
2. 点击"登录"按钮
3. 验证成功后自动跳转到数据仪表盘
4. 登录失败会显示错误提示

### 登录错误处理

| 错误提示 | 原因 | 解决方法 |
|---------|------|---------|
| 用户名或密码错误 | 账号或密码不正确 | 检查用户名和密码是否正确 |
| 登录失败 | 服务器错误 | 稍后重试或联系管理员 |

## 密码管理

### 修改密码

#### 步骤

1. 登录系统
2. 点击侧边栏的"系统设置"
3. 找到"修改密码"区域
4. 填写以下信息：
   - 当前密码
   - 新密码（至少 6 位）
   - 确认新密码
5. 点击"修改密码"按钮
6. 密码修改成功后需要重新登录

#### 密码要求

- 新密码长度不能少于 6 位
- 新密码和确认密码必须一致
- 当前密码必须正确

#### 常见问题

| 问题 | 原因 | 解决方法 |
|-----|------|---------|
| 当前密码错误 | 输入的密码不正确 | 重新输入正确的当前密码 |
| 密码不一致 | 新密码和确认密码不匹配 | 确保两次输入的新密码相同 |
| 密码长度不足 | 新密码少于 6 位 | 设置至少 6 位的新密码 |

## 退出登录

### 方法

1. 在侧边栏用户信息区域
2. 点击红色的退出按钮（LogOut 图标）
3. 系统自动清除登录状态
4. 重定向到登录页面

### 注意事项

- 退出登录会清除所有会话信息
- 未保存的数据可能会丢失
- 建议在退出前保存所有工作

## 会话管理

### 会话时长

- 默认会话时长：24 小时
- 超时会话会自动失效
- 需要重新登录

### 自动重定向

系统会在以下情况自动重定向到登录页面：

1. 访问页面时未登录
2. 会话过期
3. 手动退出登录

### 保持登录

- 在会话有效期内访问系统不会要求重新登录
- 建议定期退出登录以保障安全

## 安全建议

1. **立即修改默认密码**：首次登录后立即修改密码
2. **使用强密码**：建议使用包含字母、数字和符号的密码
3. **定期更换密码**：建议每 3 个月更换一次密码
4. **不要共享账号**：不要将账号密码提供给他人
5. **退出登录**：使用完毕后及时退出登录
6. **安全网络**：避免在公共网络环境下登录系统

## 技术实现

### 认证机制

- **方式**：Cookie-based 认证
- **令牌存储**：浏览器 Cookie
- **令牌格式**：Base64 编码的用户信息
- **会话管理**：中间件自动验证令牌

### 路由保护

- **中间件**：自动验证所有非公开路由
- **公开路由**：登录页面和 API 认证接口
- **重定向**：未认证用户重定向到登录页面

### 密码存储

- **当前实现**：Base64 编码
- **生产建议**：使用 bcrypt 或类似算法加密
- **安全性**：实际生产环境应使用更安全的方式

## 故障排除

### 无法登录

1. 检查用户名和密码是否正确
2. 确认服务器正在运行
3. 检查浏览器控制台是否有错误
4. 清除浏览器缓存和 Cookie 后重试

### 会话频繁过期

1. 检查 Cookie 是否被浏览器阻止
2. 确认系统时间设置正确
3. 检查是否有安全软件干扰

### 密码修改失败

1. 确认当前密码正确
2. 检查新密码是否符合要求
3. 确认网络连接正常
4. 查看浏览器控制台错误信息

## API 接口

### 登录接口

```
POST /api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

响应：
```json
{
  "success": true,
  "user": {
    "id": "admin-001",
    "username": "admin",
    "role": "admin",
    "createdAt": "2024-01-01T00:00:00.000Z"
  },
  "message": "登录成功"
}
```

### 修改密码接口

```
POST /api/auth/update-password
Content-Type: application/json

{
  "username": "admin",
  "oldPassword": "admin123",
  "newPassword": "newpassword123"
}
```

响应：
```json
{
  "success": true,
  "message": "密码修改成功"
}
```

## 后续优化

计划在后续版本中实现以下功能：

- [ ] 多用户支持
- [ ] 角色权限管理
- [ ] 密码强度检查
- [ ] 密码找回功能
- [ ] 双因素认证（2FA）
- [ ] 登录日志记录
- [ ] 密码加密升级（bcrypt）
- [ ] 集成外部认证（OAuth）
